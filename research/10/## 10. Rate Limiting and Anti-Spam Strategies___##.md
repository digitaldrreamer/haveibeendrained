<img src="https://r2cdn.perplexity.ai/pplx-full-logo-primary-dark%402x.png" style="height:64px;margin-right:32px"/>

# \#\# 10. Rate Limiting and Anti-Spam Strategies

### Research Questions

**Algorithms:**

- What are the different rate limiting algorithms (token bucket, leaky bucket, fixed window, sliding window)?
- What are the pros and cons of each algorithm?
- Which algorithm is best for API rate limiting?

**Implementation:**

- What rate limiting libraries are available for Node.js/Hono?
- How do you implement distributed rate limiting (Redis-based)?
- What are the trade-offs of in-memory vs distributed rate limiting?

**Dimensions:**

- Should rate limits be per IP, per user, per endpoint, or global?
- How do you handle users behind NAT or shared IPs?
- How do you rate limit authenticated vs anonymous users differently?

**Response Handling:**

- What HTTP status code should be returned for rate limit violations (429)?
- What headers should be included (X-RateLimit-Limit, X-RateLimit-Remaining, Retry-After)?
- How do you communicate rate limits to users?

**CAPTCHA Integration:**

- When should CAPTCHA be triggered (after N failed attempts, suspected bot traffic)?
- What CAPTCHA services are available (hCaptcha, reCAPTCHA, Turnstile)?
- How do you integrate CAPTCHA with your API?

**Cloudflare Features:**

- What rate limiting features does Cloudflare provide?
- Can Cloudflare rate limiting replace application-level rate limiting?
- What are the limitations of Cloudflare's free tier rate limiting?


### Desired Outputs

- Rate limiting implementation example for Hono
- Recommended rate limits for different endpoints
- CAPTCHA integration guide
- Cloudflare rate limiting configuration
- Strategy for handling legitimate high-volume users

---

Perfect! Let me create a final index document to tie everything together:

## Summary

I've created a **comprehensive, production-ready research package** on rate limiting and anti-spam strategies for your "Have I Been Drained" Solana wallet security checker. Here's what you now have:

### üìö **5 Complete Research Documents** (Ready to Download)

1. **rate-limiting-guide.md** - Comprehensive 50+ page technical reference covering:
    - All 6 rate limiting algorithms (Token Bucket ‚úì, Leaky Bucket ‚úì, Sliding Window ‚≠ê RECOMMENDED)
    - Pros/cons and best use cases for each
    - Complete Hono implementation patterns with code examples
    - Dimensioned rate limiting strategies (per-IP, per-user, per-endpoint)
    - HTTP 429 response standards with headers
    - CAPTCHA comparison (Turnstile ‚≠ê RECOMMENDED, reCAPTCHA, hCaptcha)
    - Cloudflare WAF features and limitations
    - Solana-specific RPC rate limiting strategies
    - Recommended limits by endpoint type
2. **rate-limit-impl.md** - Copy-paste implementation guide:
    - Minimal production setup (4 files)
    - Custom Redis Lua script implementation
    - Tier-based rate limiting
    - Suspicious activity detection
    - PostgreSQL schema
    - Test suite examples
    - Dev vs Production configuration
3. **rate-limit-summary.md** - Executive decision guide:
    - Decision flowcharts (which algorithm? which CAPTCHA?)
    - 3-phase implementation roadmap (Week 1-4)
    - Specific recommendations for wallet security use case
    - Recommended limits table by endpoint
    - SQL monitoring queries
    - Troubleshooting guide
4. **rate-limit-code.md** - Complete production code:
    - Full `rate-limiter.ts` module (500+ lines)
    - Full `captcha.ts` module with CAPTCHA verification
    - Complete API setup with all endpoints
    - Environment configuration (.env)
    - Cloudflare Workers deployment (wrangler.toml)
    - Quick start commands
5. **rate-limit-cards.md** - Visual reference cards:
    - Algorithm comparison matrix
    - Implementation decision tree
    - CAPTCHA comparison cards (ratings)
    - Suspicious activity detection flowchart
    - Cost estimation charts
    - Testing \& deployment checklists

### üéØ **Key Recommendations for Your Project**

**Algorithm:** Sliding Window Counter with Redis (Upstash) ‚≠ê

- Accurate rate limiting without boundary spikes
- Distributed across Cloudflare Workers
- Free tier supports your MVP needs

**CAPTCHA:** Cloudflare Turnstile ‚≠ê

- GDPR-compliant (European users)
- Free: 1M checks/month
- Invisible, frictionless UX
- Tight Cloudflare integration

**Cost:** **\$0/month for MVP** (all free tiers available)

**Implementation Time:** 16-22 hours (3-4 days at 6 hrs/day)

### üìã **Quick Start Path**

1. Copy code from `rate-limit-code.md` ‚Üí 2 hours
2. Set up Upstash Redis ‚Üí 30 minutes
3. Integrate CAPTCHA ‚Üí 2 hours
4. Test \& deploy ‚Üí 2 hours
5. **Total: 6.5 hours minimum for working MVP**

All documents are current for **December 2025**, include production-ready code, and are tailored specifically to Hono + Cloudflare Workers + Solana architecture.
<span style="display:none">[^1][^10][^11][^12][^13][^14][^15][^16][^17][^18][^19][^2][^20][^21][^22][^23][^24][^25][^26][^27][^28][^3][^4][^5][^6][^7][^8][^9]</span>

<div align="center">‚ÅÇ</div>

[^1]: https://api7.ai/blog/token-bucket-vs-leaky-best-rate-limiting-algorithm

[^2]: https://www.npmjs.com/package/@hono-rate-limiter/redis

[^3]: https://stackoverflow.com/questions/13175050/how-to-implement-rate-limiting-using-redis

[^4]: https://www.eraser.io/decision-node/api-rate-limiting-strategies-token-bucket-vs-leaky-bucket

[^5]: https://javascript.plainenglish.io/implementing-rate-limiting-with-upstash-redis-hono-and-cloudflare-workers-d0c138003a33

[^6]: https://blog.dreamfactory.com/how-distributed-rate-limiting-works-with-open-source-tools

[^7]: https://www.linkedin.com/pulse/comparing-rate-limiting-algorithms-leaky-bucket-token-aditi-mishra-r1ofc

[^8]: https://betterstack.com/community/guides/scaling-nodejs/rate-limiting-express/

[^9]: https://www.freecodecamp.org/news/build-rate-limiting-system-using-redis-and-lua/

[^10]: https://blog.algomaster.io/p/rate-limiting-algorithms-explained-with-code

[^11]: https://netcat.au/battle-of-the-captchas-recaptcha-vs-turnstile-what-to-use-in-2025/

[^12]: https://www.reddit.com/r/CloudFlare/comments/1is6kfp/is_there_a_rate_limit_in_the_free_cloudflare/

[^13]: https://altcha.org/docs/v2/how-to/captcha-react-example/

[^14]: https://loginpress.pro/hcaptcha-vs-recaptcha/

[^15]: https://developers.cloudflare.com/workers/runtime-apis/bindings/rate-limit/

[^16]: https://www.youtube.com/watch?v=UzCkSzmEq8E

[^17]: https://radicalwebdesign.co.uk/blog/recaptcha-vs-turnstile/

[^18]: https://developers.cloudflare.com/waf/rate-limiting-rules/

[^19]: https://weaviate.io/blog/hono-search-apis

[^20]: https://www.cloudflare.com/application-services/products/turnstile/

[^21]: https://drpc.org/blog/solana-rpc-optimization/

[^22]: https://thesai.org/Downloads/Volume9No7/Paper_29-An_Algorithm_that_Prevents_SPAM_Attacks.pdf

[^23]: https://hono.dev/docs/middleware/builtin/combine

[^24]: https://www.helius.dev/docs/rpc/optimization-techniques

[^25]: https://www.aikido.dev/blog/api-security-guide

[^26]: https://chainstack.com/solana-how-to-getsignaturesforaddress-1000-transaction-limit/

[^27]: https://forum.nkn.org/t/web-3-0-challenges-and-solutions-transaction-spamming-in-blockchain/4747

[^28]: https://www.youtube.com/watch?v=sdYcxzTjdbo

